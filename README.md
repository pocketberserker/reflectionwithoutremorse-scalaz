ported from https://github.com/atzeus/reflectionwithoutremorse
